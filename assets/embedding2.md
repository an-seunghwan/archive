# 차원 축소와 데이터 복원

## 1. 목적 

### 1. 저장 공간의 감소
- 용량이 큰 고차원 데이터를 저차원 데이터로 변환함으로써, 데이터의 저장 공간을 감소시킬 수 있다.
### 2. 용이한 데이터 해석
- 주어진 고차원 데이터의 상태에서는 잘 구분되지 않던 데이터가 차원축소를 수행하면 저차원 공간에서 쉽게 구분될 수 있다. 
- 고차원 데이터는 시각화를 통해 해당 데이터들의 분포를 확인하기가 어렵다. 이런 경우에 차원 축소를 수행하면 저차원 공간에서 한눈에 알아볼 수 있는 시각화가 가능하고, 추가적으로 같은 라벨을 갖는 데이터끼리 그룹지어 해석할 수 있다는 장점이 있다.

## 2. 방법

### 1. 개념
- 고차원 데이터의 차원 축소 후의 결과를 임베딩(embedding)이라고 한다.
- 고차원 데이터의 저차원 공간으로의 임베딩이 잘 되었는지 판단할 때는, **해당 임베딩을 이용해 다시 원래의 데이터로 잘 복원할 수 있는지 여부**를 이용해 판단한다. 즉, 임베딩이 주어진 데이터의 정보를 얼마나 충분히 담고 있는지를 이용해 차원 축소가 잘 되었는지를 판단하게 된다.

### 2. 수식
- 주어진 데이터를 $x$, 차원 축소를 수행하는 함수를 $f$, 임베딩을 $z$, 임베딩을 원래의 데이터로 복원하는 함수를 $g$, 복원된 데이터를 $\hat{x}$라고 하자.
- 복원이 잘 되었는지를 평가하기위해 일정한 기준이 필요한데, 주어진 데이터 $x$와 복원된 데이터 $\hat{x}$ 사이의 거리 $d(x, \hat{x})$를 정의하여 해당 거리가 **가까우면** 복원이 잘 되었다고 판단한다. 
- 따라서, 차원 축소는 주어진 모든 데이터 $x$들에 대해서 $d(x, \hat{x})$를 최소화하는 $f, g$를 찾는 문제라고 정의할 수 있다.

## 1. 예시: 주성분 분석 

<img src="https://upload.wikimedia.org/wikipedia/commons/1/15/GaussianScatterPCA.png" width="400">

- 위 그림은 2차원 공간상에 분포해있는 2차원 데이터의 예시이다. 해당 데이터가 퍼져있는 전체적인 형태는 그림에 표시된 화살표 2개를 이용해 충분히 표현이 가능한데, 고차원 데이터에 대해서 이러한 화살표를 찾는 작업이 주성분 분석의 메인 아이디어라고 할 수 있다.
- 주어진 데이터는 고차원 축들을 따라서 일정한 크기의 변동(데이터가 퍼져있는 정도, 데이터가 표현하는 정보의 크기, 전체 변동, 분산)을 가진다. 주성분 분석은 주어진 전체 변동을 가장 잘 설명할 수 있는 여러 새로운 축(주성분 축)들을 만드는 방법을 말하고, 이러한 새로운 축의 개수는 주어진 데이터의 변수의 개수와 동일하다.
- 주성분 축은 주어진 데이터의 변수들의 선형결합을 구성하는 선형결합 계수들을 의미한다. 주어진 데이터를 10차원이라고 하고, 10개의 변수가 $x_1, x_2, \cdots, x_{10}$라고 할 때, 변수들에 대한 선형결합은 실수들로 구성된 선형결합 계수 $a_1, a_2, \cdots, a_{10}$들에 대해서 $$a_1x_1 + a_2x_2 + \cdots + a_{10}x_{10}$$을 의미한다. 이때, 10차원 벡터의 선형결합의 결과는 1차원 실수임을 기억하자.
- 주성분 축들은 서로 선형 연관성이 없으며, 선형 연관성이 없다는 것은 주성분 축에 사용된 선형결합 계수 벡터 2개를 내적하면 그 값이 0이 됨을 의미한다(이는 두 선형결합 계수 벡터가 서로 직교한다는 것과 동일). 이를 수식으로 표현하면, 2개의 주성분 축을 구성하는 선형결합 계수들을 각각 $(a_1, a_2, \cdots, a_{10})$, $(b_1, b_2, \cdots, b_{10})$이라고 할 때 두 벡터의 내적 $$a_1b_1 + a_2b_2 + \cdots + a_{10}b_{10} = 0$$이 된다.

#### 활용 예시: 서울집 구별 집 가격의 주성분 분석
- 데이터: 서울시 구별 집 가격 데이터
- 설명변수: 집의 넓이, 방의 개수, 지어진 연도, 도심지로부터의 거리, 집이 속한 구의 범죄율 등
- 관심변수: 집 가격

1. 고차원 설명변수들로 구성된 관측치들을 주성분 분석을 이용해 2차원의 저차원 데이터로 요약
2. 2차원 공간상에서 차원축소된 저차원 관측치들을 주성분 축을 따라서 시각화
3. 주성분의 값에 따라 관측치들의 집 가격이 어떻게 분포해 있는지를 확인
4. 주성분 축을 구성할 때 사용된 선형결합 계수를 활용하여, 각각의 설명변수들이 집 가격 형성에 미치는 영향(예. 양/음의 관계) 파악

## 2. Restricted Boltzmann Machine (RBM)
